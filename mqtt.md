# BMS MQTT æ•°æ®è·å–æ¥å£æ–‡æ¡£

## æ–‡æ¡£ä¿¡æ¯
- **ç‰ˆæœ¬**: v2.0 (ç²¾ç®€ç‰ˆ)
- **æ›´æ–°æ—¥æœŸ**: 2025-11-28
- **é€‚ç”¨ç³»ç»Ÿ**: Edge â†’ BMS ä¼ æ„Ÿå™¨æ•°æ®ä¼ è¾“

---

## ç³»ç»Ÿæ¶æ„

### å‚¨èƒ½æŸœå†…ç½‘ç¯å¢ƒæ¶æ„ï¼ˆä»…TLSåŠ å¯†ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              å‚¨èƒ½æŸœç°åœºï¼ˆæœ¬åœ°ç½‘ç»œï¼‰                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         å‘å¸ƒæ•°æ®           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ orangepi-gateway  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  Edgeç«¯ Mosquitto     â”‚  â”‚
â”‚  â”‚                   â”‚  ssl://127.0.0.1:8883      â”‚  Broker #1 (TLS 8883) â”‚  â”‚
â”‚  â”‚ â€¢ è¯»å–ä¼ æ„Ÿå™¨æ•°æ®   â”‚                            â”‚                       â”‚  â”‚
â”‚  â”‚ â€¢ ZKPè®¤è¯è·å–Token â”‚  Topics:                   â”‚  â€¢ æ¥æ”¶æœ¬åœ°ä¼ æ„Ÿå™¨æ•°æ®   â”‚  â”‚
â”‚  â”‚ â€¢ MQTTå‘å¸ƒæ•°æ®     â”‚  - sensors/#               â”‚  â€¢ å­˜å‚¨åˆ°æœ¬åœ°SQLite    â”‚  â”‚
â”‚  â”‚                   â”‚  - devices/+/status        â”‚  â€¢ æ¡¥æ¥è½¬å‘åˆ°Cloud    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  - alerts/#                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          - devices/+/heartbeat               â”‚               â”‚
â”‚                                                              â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                                               â”‚ MQTTæ¡¥æ¥ (TLS)
                                                               â”‚ åœ°å€: <CLOUD_IP>:8884
                                                               â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                                                          â”‚
                        â”‚              ä¸Šè¡Œ (Edge â†’ Cloud)                         â”‚
                        â”‚  â€¢ sensors/#                                             â”‚
                        â”‚  â€¢ devices/+/status                                      â”‚
                        â”‚  â€¢ devices/+/heartbeat                                   â”‚
                        â”‚  â€¢ alerts/#                                              â”‚
                        â”‚                                                          â”‚
                        â”‚              ä¸‹è¡Œ (Cloud â†’ Edge)                         â”‚
                        â”‚  â€¢ commands/#                                            â”‚
                        â”‚  â€¢ control/#                                             â”‚
                        â”‚  â€¢ config/#                                              â”‚
                        â”‚  â€¢ cloud/cabinet/+/policy/#                              â”‚
                        â–¼                                                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              äº‘ç«¯æœåŠ¡å™¨ (Cloud Server)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Cloudç«¯ Mosquitto    â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚     Cloud åç«¯æœåŠ¡         â”‚  â”‚
â”‚  â”‚  Broker #2 (TLS 8884) â”‚   è®¢é˜…æ¡¥æ¥è¿‡æ¥çš„æ•°æ®    â”‚     (ç«¯å£8003)             â”‚  â”‚
â”‚  â”‚                       â”‚                       â”‚                           â”‚  â”‚
â”‚  â”‚  â€¢ æ¥æ”¶Edgeæ¡¥æ¥æ•°æ®    â”‚   ssl://mqtt:8884     â”‚  â€¢ å­˜å‚¨åˆ°PostgreSQL       â”‚  â”‚
â”‚  â”‚  â€¢ è½¬å‘å‘½ä»¤åˆ°Edge     â”‚   (å®¹å™¨å†…éƒ¨)            â”‚  â€¢ æä¾›APIç»™å‰ç«¯           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â€¢ ç®¡ç†å¤šä¸ªå‚¨èƒ½æŸœ           â”‚  â”‚
â”‚                                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•°æ®æµå‘**:
```
ä¼ æ„Ÿå™¨ â†’ orangepiè¯»å– â†’ å‘å¸ƒåˆ°Edge Broker (TLS 8883) â†’ EdgeæœåŠ¡è®¢é˜…å­˜å‚¨
                                      â†“
                               Mosquittoæ¡¥æ¥ (TLS)
                                      â†“
                          Cloud Broker (TLS 8884) â†’ CloudæœåŠ¡è®¢é˜…å­˜å‚¨ â†’ å‰ç«¯å±•ç¤º
```

**å…³é”®é…ç½®å¯¹ç…§**:
| ç»„ä»¶ | MQTT Broker åœ°å€ | ç«¯å£ | è§’è‰² |
|------|----------------|------|------|
| orangepi-gateway | ssl://127.0.0.1:8883 | 8883 | å‘å¸ƒè€…ï¼ˆè¿æ¥æœ¬åœ°Edge Brokerï¼‰ |
| EdgeæœåŠ¡ | ssl://127.0.0.1:8883 | 8883 | è®¢é˜…è€… + Brokerå®¿ä¸» |
| Edge Mosquitto | æ¡¥æ¥åˆ° <CLOUD_IP>:8884 | 8884 | æ•°æ®ä¸­è½¬ï¼ˆTLSæ¡¥æ¥ï¼‰ |
| CloudæœåŠ¡ | ssl://mqtt:8884 | 8884 | è®¢é˜…è€…ï¼ˆå®¹å™¨å†…éƒ¨è¿æ¥ï¼‰ |

**ç«¯å£åˆ†é…**:
- **Edgeç«¯ (Broker #1)**: TLSç«¯å£ **8883**ï¼ˆä»…TLSï¼Œæ— æ˜æ–‡ç«¯å£ï¼‰
- **Cloudç«¯ (Broker #2)**: TLSç«¯å£ **8884**ï¼ˆä»…TLSï¼Œæ— æ˜æ–‡ç«¯å£ï¼‰
- æ‰€æœ‰MQTTé€šä¿¡å‡ä½¿ç”¨TLSåŠ å¯†ï¼Œç¡®ä¿æ•°æ®å®‰å…¨
---

## MQTT è¿æ¥é…ç½®

### Broker ä¿¡æ¯

**Edgeç«¯MQTT Broker (Broker #1)**:
| å‚æ•° | å€¼ | è¯´æ˜ |
|------|-----|------|
| **Broker åœ°å€** | `ssl://127.0.0.1:8883` | æœ¬åœ°è¿æ¥ (æ¨è) |
| **Broker åœ°å€** | `ssl://<EDGE_IP>:8883` | å†…ç½‘IPè¿æ¥ |
| **åè®®** | MQTT v3.1.1 over TLS | åŠ å¯†ä¼ è¾“ |
| **ç«¯å£** | 8883 | TLSåŠ å¯†ç«¯å£ï¼ˆä»…TLSï¼Œæ— æ˜æ–‡ç«¯å£ï¼‰ |
| **QoS** | 1 | è‡³å°‘ä¸€æ¬¡ä¼ é€’ |
| **å®¢æˆ·ç«¯ID** | `bms-client-001` | å”¯ä¸€æ ‡è¯† |
| **è®¤è¯** | TLS è¯ä¹¦ (å¯é€‰) | æµ‹è¯•ç¯å¢ƒå¯è·³è¿‡éªŒè¯ |

**Cloudç«¯MQTT Broker (Broker #2)**:
| å‚æ•° | å€¼ | è¯´æ˜ |
|------|-----|------|
| **Broker åœ°å€** | `ssl://mqtt:8884` | Dockerå®¹å™¨å†…éƒ¨è¿æ¥ |
| **Broker åœ°å€** | `ssl://<CLOUD_IP>:8884` | å¤–éƒ¨è¿æ¥ |
| **åè®®** | MQTT v3.1.1 over TLS | åŠ å¯†ä¼ è¾“ |
| **ç«¯å£** | 8884 | TLSåŠ å¯†ç«¯å£ï¼ˆä»…TLSï¼Œæ— æ˜æ–‡ç«¯å£ï¼‰ |
| **QoS** | 1 | è‡³å°‘ä¸€æ¬¡ä¼ é€’ |
| **å®¢æˆ·ç«¯ID** | `cloud-client-001` | å”¯ä¸€æ ‡è¯† |
| **è®¤è¯** | TLS è¯ä¹¦ (å¯é€‰) | æµ‹è¯•ç¯å¢ƒå¯è·³è¿‡éªŒè¯ |

### è®¢é˜… Topic

BMS ç³»ç»Ÿåªéœ€è®¢é˜…ä»¥ä¸‹ Topic å³å¯æ¥æ”¶æ‰€æœ‰ä¼ æ„Ÿå™¨æ•°æ®:

| Topic | è¯´æ˜ | æ•°æ®é¢‘ç‡ |
|-------|------|---------|
| `sensors/#` | æ‰€æœ‰ä¼ æ„Ÿå™¨æ•°æ® (é€šé…ç¬¦) | å®æ—¶ (100ms-1s) |

**Topic æ ¼å¼**: `sensors/{device_id}/{sensor_type}`

**ç¤ºä¾‹**:
- `sensors/temperature_humidity/temperature` - æ¸©åº¦æ•°æ®
- `sensors/temperature_humidity/humidity` - æ¹¿åº¦æ•°æ®
- `sensors/co2/co2` - CO2æ•°æ®
- `sensors/co/co` - COæ•°æ®
- `sensors/smoke/smoke` - çƒŸé›¾æ•°æ®

---

## æ•°æ®æ ¼å¼

### ä¼ æ„Ÿå™¨æ•°æ® JSON æ ¼å¼

```json
{
  "device_id": "temperature_humidity",
  "sensor_type": "temperature",
  "value": 24.5,
  "unit": "Â°C",
  "timestamp": "2025-11-28T10:30:00Z",
  "quality": 100
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|
| `device_id` | string | è®¾å¤‡å”¯ä¸€æ ‡è¯† | `temperature_humidity` |
| `sensor_type` | string | ä¼ æ„Ÿå™¨ç±»å‹ | `temperature`, `humidity`, `co2`, `co`, `smoke`, `liquid_level`, `conductivity`, `flow` |
| `value` | float64 | ä¼ æ„Ÿå™¨æ•°å€¼ | `24.5` |
| `unit` | string | æµ‹é‡å•ä½ | `Â°C`, `%RH`, `ppm`, `MG/M3` |
| `timestamp` | string | ISO 8601 æ—¶é—´æˆ³ | `2025-11-28T10:30:00Z` |
| `quality` | int | æ•°æ®è´¨é‡ (0-100) | `100` |

### æ”¯æŒçš„ä¼ æ„Ÿå™¨ç±»å‹

| sensor_type | ä¸­æ–‡åç§° | å•ä½ |
|-------------|---------|------|
| `temperature` | æ¸©åº¦ | Â°C |
| `humidity` | æ¹¿åº¦ | %RH |
| `co2` | äºŒæ°§åŒ–ç¢³ | ppm |
| `co` | ä¸€æ°§åŒ–ç¢³ | MG/M3 |
| `smoke` | çƒŸé›¾ | - |
| `liquid_level` | æ¶²ä½ | % |
| `conductivity` | ç”µå¯¼ç‡ | Î¼S/cm |
| `flow` | æµé‡ | L/min |

---

## BMS å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç 

```go
package main

import (
	"crypto/tls"
	"encoding/json"
	"fmt"
	"log"

	mqtt "github.com/eclipse/paho.mqtt.golang"
)

type SensorData struct {
	DeviceID   string  `json:"device_id"`
	SensorType string  `json:"sensor_type"`
	Value      float64 `json:"value"`
	Unit       string  `json:"unit"`
	Timestamp  string  `json:"timestamp"`
	Quality    int     `json:"quality"`
}

func main() {
	opts := mqtt.NewClientOptions()
	opts.AddBroker("ssl://127.0.0.1:8883")
	opts.SetClientID("bms-client-001")

	// è·³è¿‡è¯ä¹¦éªŒè¯ (æµ‹è¯•ç¯å¢ƒ)
	tlsConfig := &tls.Config{InsecureSkipVerify: true}
	opts.SetTLSConfig(tlsConfig)

	opts.SetOnConnectHandler(func(c mqtt.Client) {
		log.Println("âœ… è¿æ¥æˆåŠŸ")
		c.Subscribe("sensors/#", 1, messageHandler)
		log.Println("âœ… å·²è®¢é˜…: sensors/#")
	})

	client := mqtt.NewClient(opts)
	if token := client.Connect(); token.Wait() && token.Error() != nil {
		log.Fatalf("âŒ è¿æ¥å¤±è´¥: %v", token.Error())
	}

	log.Println("ğŸš€ BMS MQTT å®¢æˆ·ç«¯è¿è¡Œä¸­...")
	select {}
}

func messageHandler(client mqtt.Client, msg mqtt.Message) {
	var data SensorData
	if err := json.Unmarshal(msg.Payload(), &data); err != nil {
		log.Printf("âŒ JSON è§£æå¤±è´¥: %v", err)
		return
	}

	fmt.Printf("ğŸ“Š [%s] %s: %.2f %s\n",
		data.SensorType, data.DeviceID, data.Value, data.Unit)

	// TODO: ä¿å­˜åˆ° BMS æ•°æ®åº“
	saveToBMS(data)
}

func saveToBMS(data SensorData) {
	// TODO: å®ç°æ•°æ®åº“ä¿å­˜é€»è¾‘
}
```

---

## å¿«é€Ÿæµ‹è¯•

### ä½¿ç”¨ mosquitto_sub æµ‹è¯•

**Edgeç«¯æµ‹è¯•**:
```bash
# è®¢é˜…æ‰€æœ‰ä¼ æ„Ÿå™¨æ•°æ®ï¼ˆEdgeç«¯ï¼ŒTLSç«¯å£8883ï¼‰
mosquitto_sub -h 127.0.0.1 -p 8883 --cafile /path/to/ca.crt --insecure -t "sensors/#" -v

# è®¢é˜…ç‰¹å®šä¼ æ„Ÿå™¨
mosquitto_sub -h 127.0.0.1 -p 8883 --cafile /path/to/ca.crt --insecure -t "sensors/temperature_humidity/temperature" -v
```

**Cloudç«¯æµ‹è¯•**:
```bash
# è®¢é˜…æ‰€æœ‰ä¼ æ„Ÿå™¨æ•°æ®ï¼ˆCloudç«¯ï¼ŒTLSç«¯å£8884ï¼‰
mosquitto_sub -h <CLOUD_IP> -p 8884 --cafile /path/to/ca.crt --insecure -t "sensors/#" -v
```


### è¿è¡Œ Go å®¢æˆ·ç«¯

```bash
# å®‰è£…ä¾èµ–
go get github.com/eclipse/paho.mqtt.golang

# è¿è¡Œ
go run bms_client.go
```

---

## è¾“å‡ºç¤ºä¾‹

```
ğŸš€ BMS MQTT å®¢æˆ·ç«¯å¯åŠ¨
âœ… è¿æ¥æˆåŠŸ: 127.0.0.1:8883
âœ… å·²è®¢é˜…: sensors/#
ğŸ“Š [temperature] temperature_humidity: 24.5 Â°C
ğŸ“Š [humidity] temperature_humidity: 51.3 %RH
ğŸ“Š [co2] co2: 380.0 ppm
ğŸ“Š [co] co: 0.05 MG/M3
ğŸ“Š [smoke] smoke: 0.0
ğŸ“Š [temperature] temperature_humidity: 24.6 Â°C
ğŸ“Š [humidity] temperature_humidity: 51.2 %RH
```


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ä¸‰ç«¯è¯ä¹¦æ¶æ„                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Cloudç«¯ (äº‘ç«¯ 150.158.102.52:8884)                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   â”‚  XiLi-CA (Cloud CA)                                       â”‚             â”‚
â”‚   â”‚    â””â”€â”€ Cloud MQTT Server è¯ä¹¦                             â”‚             â”‚
â”‚   â”‚                                                           â”‚             â”‚
â”‚   â”‚  é…ç½®: å•å‘ TLSï¼Œä¸éªŒè¯å®¢æˆ·ç«¯è¯ä¹¦                          â”‚             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                              â†‘                                              â”‚
â”‚                    TLS æ¡¥æ¥ (ä½¿ç”¨ ca_cloud.crt éªŒè¯)                         â”‚
â”‚                              â”‚                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚                                              â”‚
â”‚   Edgeç«¯ (æœ¬åœ° 0.0.0.0:8883)                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   â”‚  è¯ä¹¦ç›®å½•: /edge/configs/certs/                           â”‚             â”‚
â”‚   â”‚    â”œâ”€â”€ ca.crt        - Edge CA (æœ¬åœ° MQTT éªŒè¯)           â”‚             â”‚
â”‚   â”‚    â”œâ”€â”€ ca_cloud.crt  - Cloud CA (æ¡¥æ¥åˆ° Cloud éªŒè¯)       â”‚             â”‚
â”‚   â”‚    â”œâ”€â”€ server.crt/key - Edge MQTT Server è¯ä¹¦             â”‚             â”‚
â”‚   â”‚    â””â”€â”€ client.crt/key - å®¢æˆ·ç«¯è¯ä¹¦ (ç»™ OrangePi ç”¨)       â”‚             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                              â†‘                                              â”‚
â”‚                    TLS è¿æ¥ (ä½¿ç”¨ ca.crt + client.crt)                       â”‚
â”‚                              â”‚                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚                                              â”‚
â”‚   OrangePiç«¯ (æœ¬åœ°)                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚   â”‚  è¯ä¹¦ç›®å½•: /orangepi/config/certs/                        â”‚             â”‚
â”‚   â”‚    â”œâ”€â”€ ca.crt      - ä¸ Edge ca.crt ç›¸åŒ                  â”‚             â”‚
â”‚   â”‚    â”œâ”€â”€ client.crt  - ä¸ Edge client.crt ç›¸åŒ              â”‚             â”‚
â”‚   â”‚    â””â”€â”€ client.key  - ä¸ Edge client.key ç›¸åŒ              â”‚             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜