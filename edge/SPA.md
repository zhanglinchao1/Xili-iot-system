# Edgeç³»ç»Ÿ - SPAå•åŒ…æˆæƒå®Œæ•´è¯´æ˜

**Single Package Authorization (SPA) - Complete Documentation**

**ç‰ˆæœ¬**: v3.0
**æ—¥æœŸ**: 2025-10-29
**é¡¹ç›®**: Edgeå‚¨èƒ½æŸœè¾¹ç¼˜è®¤è¯ç½‘å…³
**çŠ¶æ€**: ç”Ÿäº§å°±ç»ª

---

## ğŸ“‹ ç›®å½•

1. [æ¦‚è¿°](#1-æ¦‚è¿°)
2. [å®é™…éƒ¨ç½²æ¶æ„](#2-å®é™…éƒ¨ç½²æ¶æ„)
3. [SPAè®¸å¯è¯è®¾è®¡](#3-spaè®¸å¯è¯è®¾è®¡)
4. [æŠ€æœ¯å®ç°](#4-æŠ€æœ¯å®ç°)
5. [éƒ¨ç½²æŒ‡å—](#5-éƒ¨ç½²æŒ‡å—)
6. [æµ‹è¯•éªŒè¯](#6-æµ‹è¯•éªŒè¯)
7. [æ•…éšœæ’æŸ¥](#7-æ•…éšœæ’æŸ¥)
8. [é™„å½•](#8-é™„å½•)

---

## 1. æ¦‚è¿°

### 1.1 ä»€ä¹ˆæ˜¯SPA

SPAï¼ˆSingle Package Authorizationï¼‰æ˜¯Edgeç³»ç»Ÿçš„**å•åŒ…æˆæƒæœºåˆ¶**ï¼Œç”¨äºæ§åˆ¶Edge Gatewayè½¯ä»¶çš„å•†ä¸šä½¿ç”¨æƒé™ã€‚

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… **è®¾å¤‡æ•°é‡é™åˆ¶**ï¼šæ§åˆ¶æ¯ä¸ªè®¸å¯è¯å…è®¸æ¥å…¥çš„æœ€å¤§è®¾å¤‡æ•°ï¼ˆæ”¯æŒæ— é™åˆ¶æ¨¡å¼ï¼‰
- âœ… **æ—¶é—´é™åˆ¶**ï¼šè®¾ç½®è®¸å¯è¯æœ‰æ•ˆæœŸï¼Œæ”¯æŒæŒ‰å¹´/æŒ‰æœˆæ”¶è´¹
- âœ… **è®¾å¤‡ç»‘å®š**ï¼šé€šè¿‡MACåœ°å€ç»‘å®šï¼Œé˜²æ­¢è®¸å¯è¯è¢«éæ³•è½¬ç§»
- âœ… **é˜²ä¼ªé€ **ï¼šä½¿ç”¨RSA-2048ç­¾åï¼Œé˜²æ­¢è®¸å¯è¯è¢«ç¯¡æ”¹
- âœ… **å•ç‚¹æ ¡éªŒ**ï¼šåªåœ¨è®¤è¯å…¥å£æ£€æŸ¥ï¼Œæ€§èƒ½ä¼˜åŒ–
- âœ… **å®½é™æœŸæœºåˆ¶**ï¼š72å°æ—¶å®½é™æœŸï¼Œé¿å…æœåŠ¡çªç„¶ä¸­æ–­

### 1.2 è®¾è®¡ç›®æ ‡

| ç›®æ ‡ | è¯´æ˜ |
|------|------|
| **æ— æ„Ÿé›†æˆ** | å®¢æˆ·ç«¯æ— éœ€æ”¹åŠ¨ï¼Œä¿æŒç°æœ‰ZKPè®¤è¯æµç¨‹ |
| **æœ€å°ä¾µå…¥** | ä»…åœ¨è®¤è¯æœåŠ¡å±‚æ·»åŠ æˆæƒé—¨æ§ |
| **å®‰å…¨å¯é ** | ä½¿ç”¨JWTç­¾å + MACåœ°å€ç»‘å®š |
| **å‘åå…¼å®¹** | é€šè¿‡é…ç½®å¼€å…³ï¼Œä¸å½±å“å¼€å‘ç¯å¢ƒ |

### 1.3 ä¸ZKPçš„å…³ç³»

| ç»´åº¦ | SPAè®¸å¯è¯ | ZKPé›¶çŸ¥è¯†è®¤è¯ |
|------|----------|-------------|
| **ä½œç”¨å±‚é¢** | å•†ä¸šæˆæƒ | å®‰å…¨è®¤è¯ |
| **æ ¡éªŒå†…å®¹** | è°å¯ä»¥ä½¿ç”¨ç³»ç»Ÿ | è®¾å¤‡èº«ä»½æ˜¯å¦åˆæ³• |
| **æ ¡éªŒæ—¶æœº** | è®¤è¯å…¥å£ï¼ˆä¸€æ¬¡æ€§ï¼‰ | æ¯æ¬¡è®¤è¯è¯·æ±‚ |
| **æŠ€æœ¯æ‰‹æ®µ** | RSAç­¾å + JWT | Groth16 ZKP |
| **å¤±è´¥å½±å“** | æ— æ³•å¯åŠ¨è®¤è¯æµç¨‹ | æ— æ³•è·å–è®¿é—®ä»¤ç‰Œ |

**å…³ç³»æ€»ç»“**ï¼š
- SPAæ˜¯**é—¨å«**ï¼šæ§åˆ¶è°æœ‰èµ„æ ¼è¿›å…¥è®¤è¯æµç¨‹
- ZKPæ˜¯**èº«ä»½éªŒè¯**ï¼šç¡®è®¤è¿›æ¥çš„è®¾å¤‡èº«ä»½çœŸå®å¯ä¿¡
- ä¸¤è€…ç»“åˆï¼š**å•†ä¸šæˆæƒ + å®‰å…¨è®¤è¯åŒé‡ä¿éšœ**

---

## 2. å®é™…éƒ¨ç½²æ¶æ„

### 2.1 çœŸå®åœºæ™¯è¯´æ˜

**é‡è¦**: åŸºäºå®é™…éƒ¨ç½²åœºæ™¯ï¼Œç³»ç»Ÿæ¶æ„ä¸ºï¼š

```
1ä¸ªå‚¨èƒ½æŸœ = 1ä¸ªEdgeç³»ç»Ÿ + 1ä¸ªç½‘å…³ï¼ˆå›ºå®š1:1:1å…³ç³»ï¼‰
```

#### ç‰©ç†æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å®é™…éƒ¨ç½²æ¶æ„ï¼ˆ1:1:1å›ºå®šå…³ç³»ï¼‰                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Cloud äº‘ç«¯ç³»ç»Ÿï¼ˆç®¡ç†å¤šä¸ªå‚¨èƒ½æŸœï¼‰
  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  â”‚                  â”‚                  â”‚
â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‚¨èƒ½æŸœ #1     â”‚  â”‚ å‚¨èƒ½æŸœ #2     â”‚  â”‚ å‚¨èƒ½æŸœ #3     â”‚  â”‚ å‚¨èƒ½æŸœ #N     â”‚
â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  Edge    â”‚ â”‚  â”‚ â”‚  Edge    â”‚ â”‚  â”‚ â”‚  Edge    â”‚ â”‚  â”‚ â”‚  Edge    â”‚ â”‚
â”‚ â”‚  ç³»ç»Ÿ    â”‚ â”‚  â”‚ â”‚  ç³»ç»Ÿ    â”‚ â”‚  â”‚ â”‚  ç³»ç»Ÿ    â”‚ â”‚  â”‚ â”‚  ç³»ç»Ÿ    â”‚ â”‚
â”‚ â”‚          â”‚ â”‚  â”‚ â”‚          â”‚ â”‚  â”‚ â”‚          â”‚ â”‚  â”‚ â”‚          â”‚ â”‚
â”‚ â”‚ SPAè®¸å¯è¯ â”‚ â”‚  â”‚ â”‚ SPAè®¸å¯è¯ â”‚ â”‚  â”‚ â”‚ SPAè®¸å¯è¯ â”‚ â”‚  â”‚ â”‚ SPAè®¸å¯è¯ â”‚ â”‚
â”‚ â”‚ (1ä¸ª)    â”‚ â”‚  â”‚ â”‚ (1ä¸ª)    â”‚ â”‚  â”‚ â”‚ (1ä¸ª)    â”‚ â”‚  â”‚ â”‚ (1ä¸ª)    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚
â”‚      â”‚ 1:1   â”‚  â”‚      â”‚ 1:1   â”‚  â”‚      â”‚ 1:1   â”‚  â”‚      â”‚ 1:1   â”‚
â”‚      â”‚å›ºå®š   â”‚  â”‚      â”‚å›ºå®š   â”‚  â”‚      â”‚å›ºå®š   â”‚  â”‚      â”‚å›ºå®š   â”‚
â”‚      â”‚è¿æ¥   â”‚  â”‚      â”‚è¿æ¥   â”‚  â”‚      â”‚è¿æ¥   â”‚  â”‚      â”‚è¿æ¥   â”‚
â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚
â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ç½‘å…³    â”‚ â”‚  â”‚ â”‚  ç½‘å…³    â”‚ â”‚  â”‚ â”‚  ç½‘å…³    â”‚ â”‚  â”‚ â”‚  ç½‘å…³    â”‚ â”‚
â”‚ â”‚  (1ä¸ª)   â”‚ â”‚  â”‚ â”‚  (1ä¸ª)   â”‚ â”‚  â”‚ â”‚  (1ä¸ª)   â”‚ â”‚  â”‚ â”‚  (1ä¸ª)   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚
â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚
â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ä¼ æ„Ÿå™¨ç»„  â”‚ â”‚  â”‚ â”‚ ä¼ æ„Ÿå™¨ç»„  â”‚ â”‚  â”‚ â”‚ ä¼ æ„Ÿå™¨ç»„  â”‚ â”‚  â”‚ â”‚ ä¼ æ„Ÿå™¨ç»„  â”‚ â”‚
â”‚ â”‚(10-20ä¸ª) â”‚ â”‚  â”‚ â”‚(10-20ä¸ª) â”‚ â”‚  â”‚ â”‚(10-20ä¸ª) â”‚ â”‚  â”‚ â”‚(10-20ä¸ª) â”‚ â”‚
â”‚ â”‚CO2,CO... â”‚ â”‚  â”‚ â”‚CO2,CO... â”‚ â”‚  â”‚ â”‚CO2,CO... â”‚ â”‚  â”‚ â”‚CO2,CO... â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 SPAæˆæƒå¯¹è±¡

**æ ¸å¿ƒç»“è®º**: SPAè®¸å¯è¯æˆæƒçš„æ˜¯**å•ä¸ªå‚¨èƒ½æŸœçš„EdgeæœåŠ¡ç«¯ç³»ç»Ÿ**

| ç‰¹å¾ | è¯´æ˜ |
|------|------|
| **å‚¨èƒ½æŸœ** | 1ä¸ªç‰©ç†å‚¨èƒ½æŸœ = ç‹¬ç«‹å•å…ƒ |
| **Edgeç³»ç»Ÿ** | 1ä¸ªå‚¨èƒ½æŸœåŒ…å«1ä¸ªEdgeç³»ç»Ÿ |
| **ç½‘å…³** | 1ä¸ªå‚¨èƒ½æŸœåŒ…å«1ä¸ªç½‘å…³ |
| **Edge-ç½‘å…³å…³ç³»** | **1:1 å›ºå®šè¿æ¥**ï¼ˆå…³é”®ç‰¹å¾ï¼‰ |
| **ä¼ æ„Ÿå™¨** | 1ä¸ªç½‘å…³è¿æ¥10-20ä¸ªä¼ æ„Ÿå™¨ |
| **SPAè®¸å¯è¯** | 1ä¸ªå‚¨èƒ½æŸœéœ€è¦1ä¸ªè®¸å¯è¯ |
| **Cloudç®¡ç†** | Cloudç³»ç»Ÿç®¡ç†å¤šä¸ªå‚¨èƒ½æŸœï¼ˆå¤šä¸ªEdgeï¼‰ |

### 2.3 è®¾å¤‡å®šä¹‰

åœ¨SPAè®¸å¯è¯ä¸­ï¼š

| æœ¯è¯­ | å®šä¹‰ | æ˜¯å¦è®¡æ•° |
|------|------|---------|
| **è®¾å¤‡ (Device)** | ç½‘å…³ (Gateway) | âœ… è®¡å…¥è®¸å¯è¯é™åˆ¶ |
| **ä¼ æ„Ÿå™¨ (Sensor)** | è¿æ¥åˆ°ç½‘å…³çš„ä¼ æ„Ÿå™¨ | âŒ ä¸å•ç‹¬è®¡æ•° |

**ç¤ºä¾‹**:
```
è®¸å¯è¯: max_devices = -1ï¼ˆæ— é™åˆ¶ï¼‰

å®é™…éƒ¨ç½²:
â”œâ”€ 1ä¸ªç½‘å…³
â””â”€ 15ä¸ªä¼ æ„Ÿå™¨ï¼ˆCO2, CO, æ¸©åº¦, æ¶²ä½...ï¼‰

è¯´æ˜: ç‰©ç†æ¶æ„é™åˆ¶ä¸º1ä¸ªç½‘å…³ï¼Œä¼ æ„Ÿå™¨ä¸é™åˆ¶
```

### 2.4 è®¤è¯æµç¨‹

#### æ–°æµç¨‹ï¼ˆSPA + ZKPåŒé‡è®¤è¯ï¼‰

```
ç½‘å…³è®¾å¤‡                    EdgeæœåŠ¡ç«¯
  â”‚                          â”‚
  â”‚  â‘  è¯·æ±‚è®¤è¯æŒ‘æˆ˜            â”‚
  â”‚ POST /auth/challenge      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                          â”‚ ã€SPAè®¸å¯è¯æ ¡éªŒã€‘
  â”‚                          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                          â”‚ â”‚ âœ“ RSAç­¾åéªŒè¯   â”‚
  â”‚                          â”‚ â”‚ âœ“ MACåœ°å€åŒ¹é…   â”‚
  â”‚                          â”‚ â”‚ âœ“ è¿‡æœŸæ—¶é—´æ£€æŸ¥   â”‚
  â”‚                          â”‚ â”‚ âœ“ è®¾å¤‡æ•°é‡æ£€æŸ¥   â”‚
  â”‚                          â”‚ â”‚   (max_devices) â”‚
  â”‚                          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                          â”‚     â”‚ é€šè¿‡
  â”‚                          â”‚     â–¼
  â”‚                          â”‚ ç”ŸæˆZKP Challenge
  â”‚                          â”‚
  â”‚  â‘¡ è¿”å›æŒ‘æˆ˜                â”‚
  â”‚ {challenge_id, nonce}     â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                          â”‚
  â”‚ ã€ZKPè¯æ˜è®¡ç®—ã€‘            â”‚
  â”‚ proof = Groth16.Prove()   â”‚
  â”‚                          â”‚
  â”‚  â‘¢ æäº¤ZKPè¯æ˜             â”‚
  â”‚ POST /auth/verify         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                          â”‚ ã€ZKPéªŒè¯ã€‘
  â”‚                          â”‚ âœ“ Groth16éªŒè¯
  â”‚                          â”‚
  â”‚  â‘£ è¿”å›JWTä»¤ç‰Œ             â”‚
  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                          â”‚
  â”‚  â‘¤ ä¸Šä¼ æ•°æ®                â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ JWTéªŒè¯
```

---

## 3. SPAè®¸å¯è¯è®¾è®¡

### 3.1 è®¸å¯è¯æ ¼å¼

#### JWT Claimsç»“æ„

```json
{
  "lic": "LIC-CABINET-001",        // è®¸å¯è¯ID
  "mac": "00:0c:29:3c:42:fe",      // ç»‘å®šçš„MACåœ°å€
  "max": -1,                        // æœ€å¤§è®¾å¤‡æ•°ï¼ˆ-1=æ— é™åˆ¶ï¼‰
  "iat": 1729497051,                // ç­¾å‘æ—¶é—´
  "exp": 1761033051,                // è¿‡æœŸæ—¶é—´
  "iss": "EdgeTech Vendor"          // ç­¾å‘è€…
}
```

#### è®¾å¤‡æ•°é‡é™åˆ¶æ¨¡å¼

| max_deviceså€¼ | å«ä¹‰ | è¡Œä¸º |
|--------------|------|------|
| `-1` | **æ— é™åˆ¶**ï¼ˆæ¨èï¼‰ | âœ… è·³è¿‡è®¾å¤‡æ•°é‡æ£€æŸ¥ |
| `0` | ä¸æ£€æŸ¥ï¼ˆå‘åå…¼å®¹ï¼‰ | âœ… è·³è¿‡è®¾å¤‡æ•°é‡æ£€æŸ¥ |
| `> 0` | å…·ä½“æ•°é‡é™åˆ¶ | âš ï¸ æ£€æŸ¥å¹¶é™åˆ¶è®¾å¤‡æ•°é‡ |

**æ¨èé…ç½®**: åŸºäºå®é™…åœºæ™¯ï¼ˆ1å‚¨èƒ½æŸœ=1ç½‘å…³ï¼‰ï¼Œæ¨èä½¿ç”¨ `max_devices = -1`ï¼ˆæ— é™åˆ¶ï¼‰

**ç†ç”±**:
1. âœ… ç‰©ç†æ¶æ„å·²ç»é™åˆ¶ä¸º1ä¸ªç½‘å…³
2. âœ… å‡å°‘è½¯ä»¶å±‚é¢çš„å†—ä½™æ£€æŸ¥
3. âœ… æä¾›æœ€å¤§çµæ´»æ€§
4. âœ… MACåœ°å€ç»‘å®šå’Œæœ‰æ•ˆæœŸä»ç„¶æä¾›è¶³å¤Ÿçš„ä¿æŠ¤

### 3.2 MACåœ°å€ç»‘å®š

#### MACåœ°å€æ¥æº

**ä½¿ç”¨Edgeç³»ç»Ÿï¼ˆå·¥æ§æœºï¼‰æœ¬èº«çš„MACåœ°å€**

```
è®¸å¯è¯æˆæƒå¯¹è±¡ = è¿è¡ŒEdgeè½¯ä»¶çš„æœåŠ¡å™¨/å·¥æ§æœº
æ§åˆ¶èŒƒå›´     = æ•´ä¸ªEdgeç³»ç»Ÿ
ç”Ÿæ•ˆèŒƒå›´     = æ‰€æœ‰æ¥å…¥è¯¥Edgeçš„è®¾å¤‡
```

#### è·å–MACåœ°å€å‘½ä»¤

```bash
# Linux/WSL
ip link show | grep -A1 "state UP" | grep link/ether | awk '{print $2}'
# è¾“å‡º: 00:0c:29:3c:42:fe
```

### 3.3 è¿‡æœŸå¤„ç†æœºåˆ¶

#### è¿‡æœŸå¤„ç†æµç¨‹

```
æ—¶é—´è½´:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
æœ‰æ•ˆæœŸå†…      è¿‡æœŸæ—¶é—´(ExpiresAt)   å®½é™æœŸç»“æŸ(+72h)      æ—¶é—´

ã€é˜¶æ®µ1ã€‘æœ‰æ•ˆæœŸå†… (t < ExpiresAt)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
çŠ¶æ€: âœ… æ­£å¸¸
è¡Œä¸º: è®¸å¯è¯æ ¡éªŒé€šè¿‡ï¼Œç³»ç»Ÿæ­£å¸¸è¿è¡Œ

ã€é˜¶æ®µ2ã€‘å®½é™æœŸå†… (ExpiresAt < t < ExpiresAt+72h)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
çŠ¶æ€: âš ï¸  å·²è¿‡æœŸä½†åœ¨å®½é™æœŸå†…ï¼ˆå¯ç”¨ï¼‰
è¡Œä¸º: è®¸å¯è¯æ ¡éªŒé€šè¿‡ï¼Œè®°å½•WARNINGæ—¥å¿—æé†’ç»­æœŸ

ã€é˜¶æ®µ3ã€‘å®½é™æœŸç»“æŸ (t > ExpiresAt+72h)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
çŠ¶æ€: âŒ è®¸å¯è¯å¤±æ•ˆï¼ˆä¸å¯ç”¨ï¼‰
è¡Œä¸º: è®¸å¯è¯æ ¡éªŒå¤±è´¥ï¼Œæ‹’ç»æ‰€æœ‰è®¾å¤‡è®¤è¯è¯·æ±‚
```

---

## 4. æŠ€æœ¯å®ç°

### 4.1 é…ç½®ç»“æ„

#### config.yamlé…ç½®

```yaml
# å•åŒ…æˆæƒé…ç½®
license:
  enabled: true                         # æ˜¯å¦å¯ç”¨æˆæƒæ£€æŸ¥
  path: ./configs/license.lic          # è®¸å¯è¯æ–‡ä»¶è·¯å¾„
  pubkey_path: ./configs/vendor_pubkey.pem  # å‚å•†å…¬é’¥è·¯å¾„
  grace_period: 72h                    # å®½é™æœŸï¼ˆé»˜è®¤72å°æ—¶ï¼‰
```

### 4.2 è®¾å¤‡æ•°é‡é™åˆ¶å®ç°

#### ä»£ç ä¿®æ”¹ï¼ˆæ”¯æŒæ— é™åˆ¶æ¨¡å¼ï¼‰

**æ–‡ä»¶**: `internal/device/manager.go`

```go
// 3. æ£€æŸ¥è®¾å¤‡æ•°é‡é™åˆ¶ï¼ˆä¼˜å…ˆæ£€æŸ¥è®¸å¯è¯é™åˆ¶ï¼‰
// max_devices = -1 è¡¨ç¤ºæ— é™åˆ¶
// max_devices = 0 è¡¨ç¤ºä¸æ£€æŸ¥ï¼ˆå‘åå…¼å®¹ï¼‰
// max_devices > 0 è¡¨ç¤ºå…·ä½“é™åˆ¶æ•°é‡
if m.license != nil && m.license.IsEnabled() {
    licenseMaxDevices := m.license.GetMaxDevices()
    // åªæœ‰å½“ max_devices > 0 æ—¶æ‰æ£€æŸ¥é™åˆ¶
    // -1 å’Œ 0 éƒ½è¡¨ç¤ºæ— é™åˆ¶
    if licenseMaxDevices > 0 && len(m.devices) >= licenseMaxDevices {
        return nil, fmt.Errorf("è®¸å¯è¯è®¾å¤‡æ•°é‡é™åˆ¶: %d/%d (è®¸å¯è¯å…è®¸çš„æœ€å¤§è®¾å¤‡æ•°)",
            len(m.devices), licenseMaxDevices)
    }
}
```

### 4.3 è®¤è¯æœåŠ¡é›†æˆ

#### æ ¡éªŒå…¥å£

**æ–‡ä»¶**: `internal/auth/service.go:71-79`

```go
// GenerateChallenge ç”Ÿæˆè®¤è¯æŒ‘æˆ˜
func (s *Service) GenerateChallenge(deviceID string) (*models.Challenge, error) {
    // ã€SPAå•åŒ…æˆæƒã€‘è®¸å¯è¯æ ¡éªŒï¼ˆå•ç‚¹é—¨æ§ï¼‰
    if s.license != nil && s.license.IsEnabled() {
        if err := s.license.Check(); err != nil {
            s.logger.Error("è®¸å¯è¯æ ¡éªŒå¤±è´¥",
                zap.String("device_id", deviceID),
                zap.Error(err))
            return nil, fmt.Errorf("LICENSE_001: è®¸å¯è¯æ ¡éªŒå¤±è´¥ - %w", err)
        }
    }

    // åç»­ZKPè®¤è¯æµç¨‹...
}
```

#### æ ¡éªŒé¡¹ç›®

| åºå· | æ ¡éªŒé¡¹ | è¯´æ˜ | å¤±è´¥å½±å“ |
|------|--------|------|----------|
| 1 | **ç­¾åéªŒè¯** | ä½¿ç”¨RSA-2048å…¬é’¥éªŒè¯è®¸å¯è¯ç­¾å | æ‹’ç»è®¤è¯ï¼Œè¿”å›LICENSE_001é”™è¯¯ |
| 2 | **MACåœ°å€ç»‘å®š** | æ¯”å¯¹è®¸å¯è¯MACä¸Edgeå®é™…MAC | æ‹’ç»è®¤è¯ï¼Œæç¤ºé‡æ–°ç”³è¯·è®¸å¯è¯ |
| 3 | **è¿‡æœŸæ—¶é—´** | æ£€æŸ¥å½“å‰æ—¶é—´æ˜¯å¦åœ¨æœ‰æ•ˆæœŸå†…ï¼ˆå«å®½é™æœŸï¼‰ | å®½é™æœŸåæ‹’ç»è®¤è¯ |
| 4 | **è®¾å¤‡æ•°é‡** | æ£€æŸ¥å·²æ³¨å†Œè®¾å¤‡æ•°ï¼ˆä»…max_devices>0æ—¶ï¼‰ | è¶…è¿‡é™åˆ¶æ‹’ç»æ–°è®¾å¤‡æ³¨å†Œ |

---

## 5. éƒ¨ç½²æŒ‡å—

### 5.1 è®¸å¯è¯ç”Ÿæˆæµç¨‹

#### æ­¥éª¤1: ç”Ÿæˆå¯†é’¥å¯¹ï¼ˆå‚å•†ç«¯ï¼Œä¸€æ¬¡æ€§ï¼‰

```bash
# ç”ŸæˆRSAç§é’¥ï¼ˆ2048ä½ï¼‰
openssl genrsa -out vendor_private_key.pem 2048

# ä»ç§é’¥æå–å…¬é’¥
openssl rsa -in vendor_private_key.pem -pubout -out vendor_pubkey.pem
```

#### æ­¥éª¤2: è·å–å®¢æˆ·MACåœ°å€

```bash
# Linux/WSL
ip link show | grep -A1 "state UP" | grep link/ether | awk '{print $2}'
```

#### æ­¥éª¤3: ç”Ÿæˆè®¸å¯è¯ï¼ˆå‚å•†ç«¯ï¼‰

ä½¿ç”¨è®¸å¯è¯ç”Ÿæˆå·¥å…·ï¼š

```bash
# æ— é™åˆ¶æ¨¡å¼ï¼ˆæ¨èï¼‰
./tools/license-gen/license-gen -mode license \
  -id "LIC-CABINET-001" \
  -mac "00:0c:29:3c:42:fe" \
  -max -1 \
  -days 365 \
  -privkey configs/vendor_privkey.pem \
  -output configs/license.lic

# æˆ–è€…é™åˆ¶ä¸º1ä¸ªè®¾å¤‡
./tools/license-gen/license-gen -mode license \
  -id "LIC-CABINET-001" \
  -mac "00:0c:29:3c:42:fe" \
  -max 1 \
  -days 365 \
  -privkey configs/vendor_privkey.pem \
  -output configs/license.lic
```

#### æ­¥éª¤4: éƒ¨ç½²åˆ°å®¢æˆ·ç«¯

```bash
# 1. ä¸Šä¼ è®¸å¯è¯å’Œå…¬é’¥åˆ°EdgeæœåŠ¡å™¨
scp license.lic edge-server:/path/to/Edge/configs/
scp vendor_pubkey.pem edge-server:/path/to/Edge/configs/

# 2. ä¿®æ”¹é…ç½®æ–‡ä»¶
vim configs/config.yaml
```

ä¿®æ”¹å†…å®¹ï¼š
```yaml
license:
  enabled: true                        # å¯ç”¨æˆæƒ
  path: ./configs/license.lic
  pubkey_path: ./configs/vendor_pubkey.pem
  grace_period: 72h
```

```bash
# 3. é‡å¯EdgeæœåŠ¡
./stop_all.sh && ./start_all.sh
```

### 5.2 éªŒè¯éƒ¨ç½²

```bash
# 1. æ£€æŸ¥APIè¿”å›çš„è®¸å¯è¯ä¿¡æ¯
curl -s http://localhost:8001/api/v1/license/info | python3 -m json.tool

# é¢„æœŸè¾“å‡º:
# {
#     "enabled": true,
#     "license_id": "LIC-CABINET-001",
#     "mac_address": "00:0c:29:3c:42:fe",
#     "max_devices": -1,              // æ— é™åˆ¶
#     "expires_at": "2026-10-29T...",
#     "is_expired": false,
#     "in_grace_period": false
# }

# 2. æ£€æŸ¥æ—¥å¿—ä¸­çš„è®¸å¯è¯ä¿¡æ¯
tail -f logs/backend.log | grep -i license

# 3. è®¿é—®Webç®¡ç†ç•Œé¢
# http://localhost:8000/#license
# åº”è¯¥çœ‹åˆ°"æœ€å¤§è®¾å¤‡æ•°: æ— é™åˆ¶"
```

### 5.3 Webç®¡ç†ç•Œé¢

è®¿é—® `http://localhost:8000/#license` æŸ¥çœ‹è®¸å¯è¯çŠ¶æ€ï¼š

**æ˜¾ç¤ºå†…å®¹**:
- è®¸å¯è¯ID: LIC-CABINET-001
- MACåœ°å€: 00:0c:29:3c:42:fe
- **æœ€å¤§è®¾å¤‡æ•°: æ— é™åˆ¶** (å½“max_devices=-1æ—¶)
- è¿‡æœŸæ—¶é—´: 2026-10-29
- çŠ¶æ€: âœ“ æœ‰æ•ˆ
- å‰©ä½™å¤©æ•°: çº¦365å¤©

---

## 6. æµ‹è¯•éªŒè¯

### 6.1 åŠŸèƒ½æµ‹è¯•

| æµ‹è¯•ç”¨ä¾‹ | è¾“å…¥ | é¢„æœŸç»“æœ |
|---------|------|---------|
| **æ­£å¸¸è®¸å¯è¯** | æœ‰æ•ˆè®¸å¯è¯ + MACåŒ¹é… | è®¤è¯æˆåŠŸ |
| **æ— é™åˆ¶æ¨¡å¼** | max_devices = -1 | è·³è¿‡è®¾å¤‡æ•°é‡æ£€æŸ¥ |
| **è®¸å¯è¯è¿‡æœŸ** | è¿‡æœŸæ—¶é—´ + å®½é™æœŸå·²ç»“æŸ | è®¤è¯å¤±è´¥ |
| **å®½é™æœŸå†…** | è¿‡æœŸæ—¶é—´ < å½“å‰æ—¶é—´ < è¿‡æœŸ+72h | è®¤è¯æˆåŠŸ + è­¦å‘Šæ—¥å¿— |
| **MACä¸åŒ¹é…** | è®¸å¯è¯MAC â‰  æœ¬æœºMAC | è®¤è¯å¤±è´¥ |
| **è®¸å¯è¯æœªå¯ç”¨** | enabled: false | è®¤è¯æ­£å¸¸ï¼ˆè·³è¿‡æ£€æŸ¥ï¼‰ |

### 6.2 æ€§èƒ½æµ‹è¯•

| æŒ‡æ ‡ | ç›®æ ‡ | å®é™… |
|------|------|------|
| å¯åŠ¨æ—¶é—´å¢åŠ  | < 100ms | ~50ms |
| è®¤è¯æ—¶é—´å¢åŠ  | < 1ms | ~0.1ms (å†…å­˜æ£€æŸ¥) |
| å†…å­˜å ç”¨å¢åŠ  | < 1MB | ~100KB |

### 6.3 å®‰å…¨æ€§éªŒè¯

- âœ… **ç­¾åéªŒè¯**: ç¯¡æ”¹è®¸å¯è¯åéªŒç­¾å¤±è´¥
- âœ… **å¤åˆ¶é˜²æŠ¤**: MACç»‘å®šé˜²æ­¢è·¨æœºå™¨å¤åˆ¶
- âœ… **è¿‡æœŸæ§åˆ¶**: è¿‡æœŸåè‡ªåŠ¨å¤±æ•ˆ
- âœ… **æ— é™åˆ¶å®‰å…¨**: ä»ç„¶ä¿æŠ¤MACåœ°å€å’Œæœ‰æ•ˆæœŸ

---

## 7. æ•…éšœæ’æŸ¥

### 7.1 å¸¸è§é”™è¯¯

#### é”™è¯¯1: "LICENSE_001: è®¸å¯è¯æ ¡éªŒå¤±è´¥"

**å¯èƒ½åŸå› **ï¼š
- è®¸å¯è¯æ–‡ä»¶ä¸å­˜åœ¨æˆ–è·¯å¾„é”™è¯¯
- ç­¾åéªŒè¯å¤±è´¥ï¼ˆå…¬é’¥ä¸åŒ¹é…ï¼‰
- MACåœ°å€ä¸åŒ¹é…
- è®¸å¯è¯å·²è¿‡æœŸä¸”è¶…è¿‡å®½é™æœŸ

**è§£å†³æ–¹æ³•**ï¼š
```bash
# 1. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -l configs/license.lic configs/vendor_pubkey.pem

# 2. æŸ¥çœ‹æ—¥å¿—è¯¦ç»†é”™è¯¯
tail -f logs/backend.log | grep -i license

# 3. éªŒè¯MACåœ°å€
ip link show | grep ether

# 4. æµ‹è¯•APIæŸ¥çœ‹è®¸å¯è¯ä¿¡æ¯
curl http://localhost:8001/api/v1/license/info | python3 -m json.tool
```

#### é”™è¯¯2: Webç•Œé¢ä¸æ˜¾ç¤ºè®¸å¯è¯ä¿¡æ¯

**è§£å†³æ–¹æ³•**ï¼š
```bash
# 1. å¼ºåˆ¶åˆ·æ–°æµè§ˆå™¨ç¼“å­˜
Ctrl + Shift + R (Windows/Linux)
Cmd + Shift + R (Mac)

# 2. æ£€æŸ¥å‰ç«¯æœåŠ¡
curl http://localhost:8000/

# 3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
# åº”è¯¥çœ‹åˆ°: [License] è®¸å¯è¯ç®¡ç†æ¨¡å—åˆå§‹åŒ– v1.0.0
```

### 7.2 è°ƒè¯•æ­¥éª¤

```bash
# 1. æ£€æŸ¥è®¸å¯è¯æ–‡ä»¶
ls -lh configs/license.lic configs/vendor_pubkey.pem

# 2. æŸ¥çœ‹æœ¬æœºMACåœ°å€
ip link show | grep ether

# 3. æŸ¥çœ‹è®¸å¯è¯ä¿¡æ¯
curl http://localhost:8001/api/v1/license/info | python3 -m json.tool

# 4. æŸ¥çœ‹åç«¯æ—¥å¿—
tail -f logs/backend.log | grep -E "license|License"

# 5. è®¿é—®Webç®¡ç†ç•Œé¢
# http://localhost:8000/#license
```

---

## 8. é™„å½•

### 8.1 éƒ¨ç½²æ¨¡å¼å¯¹æ¯”

#### æ¨¡å¼1: æ— é™åˆ¶æ¨¡å¼ï¼ˆæ¨èï¼‰

```yaml
max_devices: -1
```

**ç‰¹ç‚¹**:
- âœ… ä¸é™åˆ¶è®¾å¤‡æ•°é‡
- âœ… æœ€å¤§çµæ´»æ€§
- âœ… é€‚åˆ1å‚¨èƒ½æŸœ=1ç½‘å…³çš„åœºæ™¯
- âœ… ä»ç„¶éªŒè¯MACåœ°å€å’Œæœ‰æ•ˆæœŸ

#### æ¨¡å¼2: å›ºå®šæ•°é‡é™åˆ¶

```yaml
max_devices: 1
```

**ç‰¹ç‚¹**:
- âš ï¸ ä¸¥æ ¼é™åˆ¶ä¸º1ä¸ªç½‘å…³
- âš ï¸ å°è¯•æ³¨å†Œç¬¬2ä¸ªç½‘å…³ä¼šè¢«æ‹’ç»
- âœ… å¼ºåˆ¶æ‰§è¡Œ1:1å…³ç³»

### 8.2 å®é™…éƒ¨ç½²ç¤ºä¾‹

#### åœºæ™¯ï¼šæŸå…¬å¸éƒ¨ç½²10ä¸ªå‚¨èƒ½æŸœ

```
å…¬å¸: XXXå‚¨èƒ½ç§‘æŠ€
éƒ¨ç½²: 10ä¸ªå‚¨èƒ½æŸœ â†’ 10ä¸ªEdgeç³»ç»Ÿ â†’ 10ä¸ªè®¸å¯è¯

å‚¨èƒ½æŸœ #1 (åŒ—äº¬)
â”œâ”€ Edge: 192.168.1.10 (MAC: aa:bb:cc:dd:ee:01)
â”œâ”€ è®¸å¯è¯: LIC-CABINET-001 (max_devices=-1)
â”œâ”€ ç½‘å…³: 1ä¸ª
â””â”€ ä¼ æ„Ÿå™¨: 15ä¸ª

å‚¨èƒ½æŸœ #2 (ä¸Šæµ·)
â”œâ”€ Edge: 192.168.2.10 (MAC: aa:bb:cc:dd:ee:02)
â”œâ”€ è®¸å¯è¯: LIC-CABINET-002 (max_devices=-1)
â”œâ”€ ç½‘å…³: 1ä¸ª
â””â”€ ä¼ æ„Ÿå™¨: 18ä¸ª

... (å…±10ä¸ªå‚¨èƒ½æŸœ)

æ€»è®¡: 10ä¸ªè®¸å¯è¯, 10ä¸ªEdgeç³»ç»Ÿ, 10ä¸ªç½‘å…³, 150-200ä¸ªä¼ æ„Ÿå™¨
```

### 8.3 ç›¸å…³æ–‡ä»¶

#### æ ¸å¿ƒä»£ç 

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `internal/license/service.go` | è®¸å¯è¯æœåŠ¡å®ç° |
| `internal/device/manager.go:117-128` | è®¾å¤‡æ•°é‡æ£€æŸ¥ï¼ˆæ”¯æŒæ— é™åˆ¶ï¼‰ |
| `internal/auth/service.go:71-79` | SPAæ ¡éªŒå…¥å£ |
| `cmd/edge/main.go` | è®¸å¯è¯æœåŠ¡åˆå§‹åŒ– |
| `tools/license-gen/` | è®¸å¯è¯ç”Ÿæˆå·¥å…· |

#### Webç•Œé¢

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `web/js/license.js` | è®¸å¯è¯ç®¡ç†æ¨¡å— |
| `web/index.html` | è®¸å¯è¯ç®¡ç†é¡µé¢ |
| `web/css/styles.css` | è®¸å¯è¯é¡µé¢æ ·å¼ |
| `web/js/api.js` | è®¸å¯è¯APIæ¥å£ |
| `web/js/app.js` | è®¸å¯è¯è·¯ç”±é…ç½® |

#### é…ç½®æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `configs/config.yaml` | è®¸å¯è¯é…ç½® |
| `configs/license.lic` | JWTè®¸å¯è¯æ–‡ä»¶ |
| `configs/vendor_pubkey.pem` | å‚å•†å…¬é’¥ï¼ˆRSA-2048ï¼‰ |

### 8.4 APIæ¥å£

#### GET /api/v1/license/info

**æè¿°**: æŸ¥è¯¢è®¸å¯è¯ä¿¡æ¯

**å“åº”**:
```json
{
    "enabled": true,
    "license_id": "LIC-CABINET-001",
    "mac_address": "00:0c:29:3c:42:fe",
    "max_devices": -1,
    "expires_at": "2026-10-29T17:01:17+08:00",
    "is_expired": false,
    "in_grace_period": false
}
```

### 8.5 æ³¨æ„äº‹é¡¹

#### 1. ç§é’¥å®‰å…¨

- âŒ **æ°¸è¿œä¸è¦**å°†`vendor_private_key.pem`å‘é€ç»™å®¢æˆ·
- âœ… **å¿…é¡»**å°†ç§é’¥ä¿å­˜åœ¨å®‰å…¨ä½ç½®
- âœ… **å»ºè®®**å®šæœŸå¤‡ä»½ç§é’¥

#### 2. æ—¶é—´åŒæ­¥

- è®¸å¯è¯éªŒè¯ä¾èµ–ç³»ç»Ÿæ—¶é—´
- å»ºè®®é…ç½®NTPæ—¶é—´åŒæ­¥
- å®½é™æœŸé»˜è®¤72å°æ—¶

#### 3. æ— é™åˆ¶æ¨¡å¼å®‰å…¨æ€§

å³ä½¿ä½¿ç”¨æ— é™åˆ¶æ¨¡å¼ï¼ˆmax_devices=-1ï¼‰ï¼Œè®¸å¯è¯ä»ç„¶æä¾›ï¼š
- âœ… MACåœ°å€ç»‘å®šï¼ˆé˜²æ­¢è®¸å¯è¯è¢«å¤åˆ¶åˆ°å…¶ä»–æœåŠ¡å™¨ï¼‰
- âœ… æœ‰æ•ˆæœŸæ§åˆ¶ï¼ˆé˜²æ­¢è¿‡æœŸåç»§ç»­ä½¿ç”¨ï¼‰
- âœ… RSA-2048ç­¾åï¼ˆé˜²æ­¢è®¸å¯è¯è¢«ä¼ªé€ æˆ–ç¯¡æ”¹ï¼‰
- âœ… å®½é™æœŸæœºåˆ¶ï¼ˆ72å°æ—¶å®¹é”™æœŸï¼‰

---

## 9. æ€»ç»“

### 9.1 å®æ–½æ•ˆæœ

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **ä»£ç æ–°å¢** | ~350è¡Œ |
| **ä»£ç ä¿®æ”¹** | ~70è¡Œ |
| **æ€§èƒ½å½±å“** | < 1ms/æ¬¡è®¤è¯ |
| **å®‰å…¨çº§åˆ«** | â­â­â­â­â­ |

### 9.2 æ ¸å¿ƒä¼˜åŠ¿

1. âœ… **æ— æ„Ÿé›†æˆ** - å®¢æˆ·ç«¯é›¶æ”¹åŠ¨
2. âœ… **æœ€å°ä¾µå…¥** - åªæ”¹è®¤è¯å…¥å£
3. âœ… **çµæ´»é…ç½®** - æ”¯æŒæ— é™åˆ¶/å›ºå®šæ•°é‡/è‡ªå®šä¹‰
4. âœ… **é«˜æ€§èƒ½** - å†…å­˜ç¼“å­˜ï¼Œé›¶I/O
5. âœ… **å‘åå…¼å®¹** - é…ç½®å¼€å…³æ§åˆ¶
6. âœ… **æ˜“äºéƒ¨ç½²** - ä¸¤ä¸ªæ–‡ä»¶å³å¯
7. âœ… **Webç®¡ç†** - å¯è§†åŒ–è®¸å¯è¯ç®¡ç†ç•Œé¢

### 9.3 æ¨èé…ç½®ï¼ˆåŸºäºå®é™…åœºæ™¯ï¼‰

```yaml
license:
  enabled: true
  path: ./configs/license.lic
  pubkey_path: ./configs/vendor_pubkey.pem
  grace_period: 72h
```

```json
{
  "lic": "LIC-CABINET-001",
  "mac": "00:0c:29:3c:42:fe",
  "max": -1,                    // æ— é™åˆ¶ï¼ˆæ¨èï¼‰
  "exp": 1761033051
}
```

**ç†ç”±**: åŸºäº1å‚¨èƒ½æŸœ=1Edge=1ç½‘å…³çš„å›ºå®šæ¶æ„ï¼Œæ— é™åˆ¶æ¨¡å¼æœ€åˆé€‚ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: v3.0
**æœ€åæ›´æ–°**: 2025-10-29
**ç»´æŠ¤è€…**: Edge Team
