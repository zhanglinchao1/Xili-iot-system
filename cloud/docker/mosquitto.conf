# =============================================================================
# Mosquitto MQTT Broker配置文件 - Cloud端 (Broker #2) - 仅TLS
# =============================================================================
# 端口分配:
#   - Cloud端 (Broker #2): TLS 8884 (仅加密)
#   - Edge端 (Broker #1): TLS 8883 (仅加密)
# =============================================================================

# TLS加密监听端口 (用于Cloud后端和Edge桥接连接)
listener 8884
protocol mqtt
allow_anonymous true

# TLS证书配置
cafile /mosquitto/certs/ca.crt
certfile /mosquitto/certs/server.crt
keyfile /mosquitto/certs/server.key

# TLS版本要求(TLS 1.2及以上)
tls_version tlsv1.2

# 不要求客户端证书（单向TLS）
require_certificate false

# WebSocket支持(可选)
listener 9001
protocol websockets
allow_anonymous true

# 持久化配置
persistence true
persistence_location /mosquitto/data/

# 日志配置
log_dest file /mosquitto/log/mosquitto.log
log_dest stdout
log_type error
log_type warning
log_type notice
log_type information

# 连接配置
max_connections -1
max_inflight_messages 20
max_queued_messages 1000

# 消息大小限制(10MB)
max_packet_size 10485760

# 保留消息配置
retained_persistence true

# 队列配置
queue_qos0_messages false

# 自动保存间隔(秒)
autosave_interval 60

# 系统主题
sys_interval 10
